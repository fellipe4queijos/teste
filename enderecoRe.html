<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description"
        content="Descrição do Mercado Trovão, seu mercado online para eletrônicos, roupas e mobília.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercado Trovão</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>
    <script src="https://unpkg.com/imask"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/css/intlTelInput.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- Incluir a biblioteca jQuery Mask Plugin -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <link rel="stylesheet" href="pro.css" />

    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const sidebarWidth = window.getComputedStyle(sidebar).width;
            const currentLeft = window.getComputedStyle(sidebar).left;

            sidebar.style.left = currentLeft === `-${sidebarWidth}` ? '0' : `-${sidebarWidth}`;
        }
    </script>

    <style>
        .pal {
            width: 100%;
            align-self: center;
            align-items: center;
            margin-left: 30%;
        }

        input.is-invalid {
    border-color: red;
}

.tex{
    font-size: 28px;
    color: blue;
    align-self: center;
    margin-left: 40%;
    font-weight: 100;
    font-family: 'Poppins', sans-serif;
    font-weight: bold;
}


        
    </style>

</head>

<body>
    <!-- Cabeçalho adaptado -->
    <header class="header">


        <div class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleSidebar()">&#10006;</button>
            <nav>
              <ul>
                  <li><a href="inicial.html">Início</a></li>
                  <li><a href="meusPedidos.html">Meus Pedidos</a></li>
                  <li><a href="configDados.html">Meus Dados</a></li>
                  <li><a href="cadastroTransportadora.html">Cadastrar Transporadora</a></li>
                  <li><a href="cadastroCliente.html">Cadastrar cliente</a></li>
                  <li><a href="cadastroFornecedor.html">Cadastrar Fornecedor</a></li>
                  <li><a href="cadastroProduto.html">Cadastrar Produto</a></li>
                  
                </ul>
                </nav>
          </div>
       
    
    
          <button class="open-sidebar-btn" onclick="toggleSidebar()">&#9776;</button>
    
    
       
          <div class="container">
            <a href="inicial.html"><div class="logo"></a>
              <a href="inicial.html"><img src="img/logo.webp" alt="Logo Mercado Trovão"></a>
             <a href="inicial.html"> <h1>Mercado Trovão</h1></a>
            </div>
            <div class="search-bar">
              <input type="text" placeholder="Buscar produtos...">
              <button>Pesquisar</button>
            </div>
            <div class="auth-buttons">
              <a href="login.html"><button>Log In</button></a>
              <a href="cadastrar.html"><button>Cadastrar</button></a>
              <div class="cart-icon" id="cart-icon">
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count" id="cart-count">0</span>
                <div class="cart-dropdown" id="cart-dropdown">
                  <!-- Itens do carrinho -->
                </div>
              </div>
            </div>
          </div>
      </header>

    <div class="pal">

        <div class="tex">Endereço</div>

        <label for="cep">CEP:</label>
        <div class="col">

            <div class="cep">
                <input type="text" id="cep" placeholder="00000-000" />
            </div>
            <div class="cePbutton">
            <button id="buscarCep">Buscar CEP</button>
            </div>
        </div>

        <div class="coluna">

            <div class="col">
                <label for="log">Logradouro:</label>
                <div class="cepLog">
                    <input name="log" id="log" placeholder="Digite o logradouro">
                </div>
            </div>
            <div class="col">
                <label for="num">Número:</label>
                <div class="numCep">
                    <input name="num" id="num" placeholder="número">
                </div>
            </div>
        </div>
        <div class="coluna">
            <div class="col">
                <label for="com">Complemento:</label>
                <div class="comple">
                    <input name="com" id="com" placeholder="Digite o Complemento">
                </div>
            </div>
            <div class="col">
                <label for="bairro">Bairro:</label>
                <input name="bairro" id="bairro" placeholder="Digite o Bairro">
            </div>
        </div>

        <div class="coluna">

            <div class="col">
                <label for="estado">Estado:</label>
                <select name="estado" id="estado">
                    <option value="">Selecione o estado</option>
                </select>
            </div>
            <div class="col">
                <label for="cidade">Cidade:</label>
                <select name="cidade" id="cidade">
                    <option value="">Selecione a cidade</option>
                </select>
            </div>
            
        </div>
        <div class="col">
            <div class="cePbutton">
            <button id="continuarBtn">Continuar</button>
</div>
        </div>
        
    </div>
    <script>


window.onload = function () {

        
   
        applyMasks();


        };

        function applyMasks() {
            $(document).ready(function () {
               
                $('#cep').mask('00000-000');
                
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartDropdown = document.getElementById('cart-dropdown');
            const cartCount = document.getElementById('cart-count');

            // Atualizar o número de itens no carrinho
            cartCount.textContent = cart.length;

            // Renderizar os itens no dropdown do carrinho
            if (cart.length > 0) {
                cartDropdown.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <p>${item.name} - ${item.quantity}x R$${item.price.toFixed(2)}</p>
                    </div>
                `).join('');

                cartDropdown.innerHTML += `
                    <div class="cart-footer">
                        <button onclick="checkout()">Realizar Compra</button>
                    </div>
                `;
            } else {
                cartDropdown.innerHTML = '<p>Carrinho vazio.</p>';
            }
        });

        function checkout() {
            alert('Indo para a página de pagamento.');
            window.location.href = 'realizarCompra.html';
        }



   

        // Função para aplicar as máscaras


        $(document).ready(function () {

            function carregarEstados() {
                $.ajax({
                    url: 'https://servicodados.ibge.gov.br/api/v1/localidades/estados?orderby=nome',
                    type: 'GET',
                    dataType: 'JSON',
                    success: function (estados) {
                        let sele = $('#estado');
                        sele.empty().append('<option value="">Selecione o estado</option>');
                        estados.forEach(function (estado) {
                            let option = $('<option>').val(estado.sigla).text(estado.nome);
                            sele.append(option);
                        });
                    },
                    error: function () {
                        alert("Erro ao carregar estados.");
                    }
                });
            }
            carregarEstados();

            function carregarCidades() {
                $.ajax({
                    url: 'https://servicodados.ibge.gov.br/api/v1/localidades/municipios?orderby=nome',
                    type: 'GET',
                    dataType: 'JSON',
                    success: function (cidades) {
                        let city = $('#cidade');
                        city.empty().append('<option value="">Selecione a cidade</option>');
                        cidades.forEach(function (cidade) {
                            let option = $('<option>').val(cidade.id).text(cidade.nome + " - " + cidade.microrregiao.mesorregiao.UF.sigla);
                            city.append(option);
                        });
                    },
                    error: function () {
                        alert("Erro ao carregar cidades.");
                    }
                });
            }
            carregarCidades();

            function carregarCidadesPorEstado(estadoId) {
                $.ajax({
                    url: `https://servicodados.ibge.gov.br/api/v1/localidades/estados/${estadoId}/municipios?orderby=nome`,
                    type: 'GET',
                    dataType: 'JSON',
                    success: function (cidades) {
                        let city = $('#cidade');
                        city.empty().append('<option value="">Selecione a cidade</option>');
                        cidades.forEach(function (cidade) {
                            let option = $('<option>').val(cidade.id).text(cidade.nome);
                            city.append(option);
                        });
                    },
                    error: function () {
                        alert("Erro ao carregar cidades.");
                    }
                });
            }


            $('#estado').change(function () {
                let estadoId = $(this).val();
                if (estadoId) {
                    carregarCidadesPorEstado(estadoId);
                } else {
                    carregarCidades();
                }
            });


            $("#buscarCep").click(function () {
                let cep = $("#cep").val();

                $.getJSON(`https://viacep.com.br/ws/${cep}/json/`)
                    .done(function (result) {
                        $("#cep").removeClass('is-invalid');

                        $("#log").val(result.logradouro);
                        $("#num").val(result.numero);
                        $("#com").val(result.complemento);
                        $("#bairro").val(result.bairro);
                        $("#estado").val(result.uf);
                        $("#cidade").empty().append(new Option(result.localidade, result.localidade));
                    })
                    .fail(function () {
      
            $("#cep").addClass('is-invalid');
        });
            });

        });



        $(document).ready(function () {
    // Função para validar os campos obrigatórios
    function validarCampos() {
        const camposObrigatorios = ["#cep", "#log", "#num", "#bairro", "#estado", "#cidade"];
        let camposPreenchidos = true;

        camposObrigatorios.forEach(function (campo) {
            if ($(campo).val().trim() === "") {
                camposPreenchidos = false;
                $(campo).css("border", "2px solid red"); // Destacar o campo vazio
            } else {
                $(campo).css("border", ""); // Remover destaque se preenchido
            }
        });

        return camposPreenchidos;
    }

    // Evento do botão "Buscar CEP"
    $("#buscarCep").click(function () {
        let cep = $("#cep").val();

        $.getJSON(`https://viacep.com.br/ws/${cep}/json/`)
            .done(function (result) {
                $("#log").val(result.logradouro);
                $("#num").val(result.numero);
                $("#com").val(result.complemento);
                $("#bairro").val(result.bairro);
                $("#estado").val(result.uf);
                $("#cidade").empty().append(new Option(result.localidade, result.localidade));
            })
           ;
    });

    // Evento do botão "Continuar"
    $("#continuarBtn").click(function () {
        if (validarCampos()) {
            window.location.href = "./finalizarCompra.html";
            // Aqui você pode redirecionar para outra página ou continuar o processo
        } 
    });
});

function displayCartItems() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const cartContent = document.getElementById('cart-content');

        if (cart.length === 0) {
            cartContent.innerHTML = '<p>Nenhum item no carrinho.</p>';
            return;
        }

        cartContent.innerHTML = cart.map(item => `
            <div class="cart-item">
                <p>${item.name} - ${item.quantity}x R$${item.price.toFixed(2)}</p>
            </div>
        `).join('');
    }

    // Chama a função ao carregar a página
   

    const addToCartButtons = document.querySelectorAll('.add-to-cart');
    const cartIcon = document.getElementById('cart-icon');
    const cartDropdown = document.getElementById('cart-dropdown');
    const cartCount = document.getElementById('cart-count');


    let cart = [];


    // Função para exibir a caixa de diálogo de quantidade
    function showQuantityDialog(product) {
      const quantity = prompt('Selecione a quantidade:', 1);
      if (quantity) {
        addToCart(product, quantity);
      }
    }


    // Função para adicionar um produto ao carrinho
    function addToCart(product, quantity) {
      const cartItem = cart.find(item => item.id === product.id);
      if (cartItem) {
        cartItem.quantity += parseInt(quantity);
      } else {
        cart.push({ ...product, quantity: parseInt(quantity) });
      }
      updateCart();
    }


    // Função para atualizar o carrinho
    function updateCart() {
      cartCount.textContent = cart.length;
      cartDropdown.innerHTML = cart.map(item => `
        <div class="cart-item">
          <p>${item.name} - ${item.quantity}x R$${item.price}</p>
        </div>
      `).join('');
      cartDropdown.innerHTML += `
        <div class="cart-footer">
          <button onclick="checkout()">Realizar Compra</button>
        </div>
      `;
    }

     // Event listeners
     addToCartButtons.forEach(button => {
      button.addEventListener('click', () => {
        const product = {
          id: 1,
          name: 'Smartphone Samsung Galaxy S23',
          price: 2699
        };
        showQuantityDialog(product);
      });
    });


    cartIcon.addEventListener('click', () => {
      cartDropdown.classList.toggle('show');
    });


   

    document.getElementById('continuarBtn').addEventListener('click', function () {
        const endereco = {
            cep: document.getElementById('cep').value,
            logradouro: document.getElementById('log').value,
            numero: document.getElementById('num').value,
            complemento: document.getElementById('com').value,
            bairro: document.getElementById('bairro').value,
            estado: document.getElementById('estado').value,
            cidade: document.getElementById('cidade').value
        };

        // Armazenar no localStorage
        localStorage.setItem('endereco', JSON.stringify(endereco));

        
    });



    </script>
</body>

</html>